类型| innodb | MyISAM | 
---|---|---
count(*) | 不存储 | 存储
全文索引 | 5.6之前不支持 | 支持
==事务== | 支持 | 不支持
外键 | 支持 | 不支持
锁 | 支持==行锁== | 只支持表锁

### 数据库四种特性
1. 原子性（Atomicity）
2. 一致性（Consistency）
3. 隔离性（Isolation）
4. 持久性（Durability）

### 三种事务并发问题
- 脏读：读取到其他会话中未提交事务修改的数据
- 不可重复读 （更新导致问题）
- 幻读 （插入导致问题）


### 事务的四种隔离级别
1. 读未提交，
2. 读已提交，
3. 重复读：在同一个事务内的查询都是事务开始时刻一致的，InnoDB默认级别。在SQL标准中，该隔离级别消除了不可重复读
4. 串行

### 并发控制
* 普通锁（串行）
* 共享锁&排他锁（读读并发）
* 数据多版本（读写并发）==MVCC==

### InnoDB的mvcc设计
- ==redo==：修改行为先写到redo日志里，再定期刷到磁盘上。（随即写优化为顺序写）
- ==undo==：有修改行为时，旧版本放到undo日志里，回滚用的undo日志
- ==回滚段==：存放unido日志的地方

> innodb支持高并发的原因：mvcc的设计，实现了快照读（一致性不加锁）

### select
- select * from t where id>2; 不加锁
- select * from t where id>2 lock in share mode; 加锁
- select * from t where id>2 for update; 加锁

### innodb七种锁
- 自增锁（有自增列的表的插入）（表）
- 共享锁（读）  排他锁（修改删除）（行）
- 意向锁（共享&排他）（表）为了表锁获取，快速避免冲突
- 插入意向锁（没有自增列的插入的前置锁）
- 记录锁（select * from t where id=1 for update;）(行)
- 间隙锁（锁索引记录的间隔）防止幻读 （行）
- 临建锁（记录锁+间隙锁）防止幻读（行）

### innodb索引
- 聚集索引（叶子节点pk和存储记录）
- 普通索引（叶子节点存储pk）（普通索引走两遍）
- MyISAM 索引和记录是分开存的




