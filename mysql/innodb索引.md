### innodb索引（不支持哈希索引）
- 聚集索引（叶子节点pk和存储记录）
- 普通索引（叶子节点存储pk）（普通索引走两遍）
- MyISAM 索引和记录是分开存的

### 哈希&树索引
- 哈希 O(1)
- 树 O(lg(n))

### 使用数索引的原因
对于这样一个单行查询的SQL需求：
select * from t where name=”shenjian”;
确实是哈希索引更快，因为每次都只查询一条记录。
画外音：所以，如果业务需求都是单行访问，例如passport，确实可以使用哈希索引。
 
但是对于排序查询的SQL需求：
分组：group by
排序：order by
比较：<、>
…
哈希型的索引，时间复杂度会退化为O(n)，而树型的“有序”特性，依然能够保持O(log(n)) 的高效率。


### B+树
- 二叉查找树 -> m叉搜索树(B树) -> B+树
- 二叉查找树 -> 平衡二叉查找树 -> 红黑树

#### b树
- 叶子节点，非叶子结点都存储数据
- 优点：m叉导致高度很低, 完美利用“局部性原理”，(每个节点存储n个数据)

#### b+树特点
- 非叶子节点不再存储数据，数据只存储在同一层的叶子节点上；
> 画外音：B+树中根到每一个节点的路径长度一样，而B树不是这样。
- 叶子之间，增加了链表，获取所有节点，不再需要中序遍历；

#### b+树优势相对于b树优势
- 范围查找，定位min与max之后，中间叶子节点，就是结果集，不用中序回溯；
> 画外音：范围查询在SQL中用得很多，这是B+树比B树最大的优势。
- 叶子节点存储实际记录行，记录行相对比较紧密的存储，适合大数据量磁盘存储；非叶子节点存储记录的PK，用于查询加速，适合内存存储；
- 非叶子节点，不存储实际记录，而只存储记录的KEY的话，那么在相同内存的情况下，B+树能够存储更多索引；

#### 局部性原理
- 内存读写块，磁盘读写慢，而且慢很多；
- 磁盘预读：磁盘读写并不是按需读取，而是按页预读，一次会读一页的数据，每次加载更多的数据，如果未来要读取的数据就在这一页中，可以避免未来的磁盘IO，提高效率；
> 画外音：通常，一页数据是4K。
- 局部性原理：软件设计要尽量遵循“数据读取集中”与“使用到一个数据，大概率会使用其附近的数据”，这样磁盘预读能充分提高磁盘IO；

### 总结
数据库索引用于加速查询 <br>
虽然哈希索引是O(1)，树索引是O(log(n))，但SQL有很多“有序”需求，故数据库使用树型索引 <br>
InnoDB不支持哈希索引 <br>
数据预读的思路是：磁盘读写并不是按需读取，而是按页预读，一次会读一页的数据，每次加载更多的数据，以便未来减少磁盘IO <br>
局部性原理：软件设计要尽量遵循“数据读取集中”与“使用到一个数据，大概率会使用其附近的数据”，这样磁盘预读能充分提高磁盘IO <br>
数据库的索引最常用B+树： <br>
(1)很适合磁盘存储，能够充分利用局部性原理，磁盘预读； <br>
(2)很低的树高度，能够存储大量数据； <br>
(3)索引本身占用的内存很小；<br>
(4)能够很好的支持单点查询，范围查询，有序性查询；<br>



